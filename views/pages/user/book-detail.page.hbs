<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item"><a href="/category/{{book.categoryId.slug}}">{{book.categoryId.name}}</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">{{book.title}}</li>
    </ol>
</nav>


<article id="book-detail" class="book-detail">
    <div class="detail-header">

        <img class="cover-skeleton" src="/api/image/{{book._id}}" alt="{{book.title}}">
        <div class="meta">
            <h1 id="book-title">{{book.title}}</h1>
            <div class="meta-grid">
                <div><span class="label">Author: </span><span id="book-author" class="value">{{book.author}}</span>
                </div>
                <div><span class="label">Genre: </span><a id="book-genre" class="chip">{{book.categoryId.name}}</a>
                </div>
                <div><span class="label">Published: </span><span id="book-year"
                        class="value">{{book.publishedYear}}</span></div>
            </div>
            <p id="book-desc" class="desc"></p>
            <div>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <h3>- Description: </h3>
                    <button id="btn-summarize" style="margin-left: 12px;" data-slug="{{book.slug}}" class="btn">AI
                        Summary</button>
                </div>

                <p id="ai-summary" class="ai-summary muted"></p>
                <h3> - Impressions:</h3>
                <p id="book-review" class="review">
                    {{#if book.review}}
                    {{book.review}}
                    {{else}}
                    Updating...
                    {{/if}}
                </p>
            </div>
        </div>
    </div>
</article>

{{#if relatedBooks.length}}
<section class="section">
    <div class="section-head">
        <h2>Similar Genres</h2>

    </div>
    <div id="related-list" class="book-row">

        {{#each relatedBooks}}
        <a class="book-card" href="/sach/{{this.slug}}">
            <img class="cover" src="/api/image/{{this._id}}" alt="{{this.slug}}">
            <div class="book-body">
                <h3 class="title">{{this.title}}</h3>
                <p class="author">{{this.author}}</p>
            </div>
        </a>
        {{/each}}
    </div>
</section>
{{/if}}

<script type="module" src="/javascripts/module/book-detail.module.js"></script>
{{!-- <script>
    document.addEventListener('DOMContentLoaded', () => {
        const btn = document.getElementById("btn-summarize");
        const slug = btn.getAttribute('data-slug')
        console.log(slug)
        if (btn) {
            btn.addEventListener("click", async () => {
                btn.disabled = true;
                btn.textContent = "Đang mô tả vui lòng đợi...";
                const desc = document.getElementById("book-review").innerText;
                const res = await fetch("/api/ai/summarize", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ slug })
                });
                const data = await res.json();
                document.getElementById("ai-summary").innerText = data.summary || "Không tóm tắt được";
                btn.textContent = "Tóm tắt bằng AI";
                btn.disabled = false;
            });
        }

    })
</script> --}}